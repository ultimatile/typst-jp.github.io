Typstには数式を組版するための特別な[構文]($syntax/#math)とライブラリ関数があります。
数式は、テキスト中にインラインで、あるいは独立したブロックのいずれかで表示できます。
始まりと終わりに少なくとも1つの空白がある場合（例えば、`[$ x^2 $]`）はブロックとして組版されます。

# 変数
数式モードでは1文字は常にそのまま表示されます。
しかし、複数の文字は変数か関数として解釈されます。
複数の文字を文字通りに表示するには引用符で囲んでください。
1文字の変数にアクセスしたい場合は[ハッシュ構文]($scripting/#expressions)を使用してください。

```example
$ A = pi r^2 $
$ "area" = pi dot "radius"^2 $
$ cal(A) :=
    { x in RR | x "is natural" } $
#let x = 5
$ #x < 17 $
```

# 記号
数式モードでは`pi`、`dot`、`RR`などのさまざまな[記号]($category/symbols/sym)が利用可能です。
多くの数式記号ではバリアントが利用可能です。
記号に[修飾子]($symbol)を適用することで異なるバリアントを選択できます。
Typstはさらに`=>`のような、記号を近似するいくつかの省略記法を認識します。
そのような省略記法が存在する場合、記号ドキュメントのリストに記載されています。

```example
$ x < y => x gt.eq.not y $
```

# 改行
数式には改行を含めることもできます。
各行には、その場所で配置することを指定する、1つまたは複数の _配置点_（`&`）を含めることができます。

```example
$ sum_(k=0)^n k
    &= 1 + ... + n \
    &= (n(n+1)) / 2 $
```

# 関数呼び出し
数式モードはハッシュプレフィックスを用いない特別な関数呼び出しをサポートしています。
このような「数式呼び出し」内では、引数リストは以下の通りコード中とは少し異なる動作をします。

- その中では、Typstは依然として「数式モード」です。
したがって、その中で数式を直接書くことができますが、コード式を渡すには（数式構文で利用可能なstringを除いて）ハッシュ構文を使う必要があります。
- 位置引数、名前付き引数、引数展開をサポートしています。
- 後続のコンテンツブロックはサポートされていません。
- 2次元引数リストのための追加の構文があります。
セミコロン（`;`）はその前のカンマ区切りの引数を配列引数へとマージします。

```example
$ frac(a^2, 2) $
$ vec(1, 2, delim: "[") $
$ mat(1, 2; 3, 4) $
$ mat(..#range(1, 5).chunks(2)) $
$ lim_x =
    op("lim", limits: #true)_x $
```

数式呼び出しでカンマやセミコロンをそのまま書きたい場合は、バックスラッシュを用いてエスケープしてください。
一方、コロンは識別子の直後にあるときにのみ特別な方法で認識されるため、そのまま表示したい場合は単にその前に空白を挿入してください。

前にハッシュがある関数呼び出しは通常のコードの関数呼び出しで、これらの規則に影響されません。

# 配置
数式が複数の _配置点_（`&`）を含む場合、右揃えと左揃えが交互に行われる列のブロックが作成されます。
以下の例では、`(3x + y) / 7`という式は右揃えで、`= 9`が左揃えです。
"given"という単語も左揃えです。これは`&&`が行内に2つの配置点を作成し、2回配置方法が切り替わるためです。
`& &`と`&&`は全く同じように振る舞います。
一方、"multiply by 7"は、その前に`&`がただ1つあるため右揃えです。
各配置点は単に右揃えと左揃えを交互に切り替えます。

```example
$ (3x + y) / 7 &= 9 && "given" \
  3x + y &= 63 & "multiply by 7" \
  3x &= 63 - y && "subtract y" \
  x &= 21 - y/3 & "divide by 3" $
```

# 数式フォント
以下に示すように、[show-setルール]($styling/#show-rules)を用いて数式フォントの設定が可能です。
数式組版に適しているのは一部の特別なOpenType数式フォントのみであることに注意してください。

```example
#show math.equation: set text(font: "Fira Math")
$ sum_(i in NN) 1 + i $
```

# mathモジュール
全ての数学関数は、数式中ではデフォルトで利用できる`math`[モジュール]($scripting/#modules)に属しています。
数式外では、`math.`プレフィックスを付けるとアクセスできます。
