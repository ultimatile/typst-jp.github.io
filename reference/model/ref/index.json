{"route":"/docs/reference/model/ref/","title":"Reference","description":"Documentation for the `ref` function.","part":null,"outline":[{"id":"summary","name":"概要","children":[]},{"id":"例","name":"例","children":[]},{"id":"syntax","name":"Syntax","children":[]},{"id":"カスタム","name":"カスタム","children":[]},{"id":"parameters","name":"引数","children":[{"id":"parameters-target","name":"target","children":[]},{"id":"parameters-supplement","name":"supplement","children":[]},{"id":"parameters-form","name":"form","children":[]}]}],"body":{"kind":"func","content":{"path":[],"name":"ref","title":"Reference","keywords":[],"oneliner":"ラベルや参考文献への参照。","element":true,"contextual":false,"deprecation":null,"details":"<p>ラベルや参考文献への参照。</p>\n<p>ラベルを指定して、その参照を生成します。\n参照の<a href=\"/docs/reference/model/ref/#parameters-form\"><code>form</code></a>には<code><span class=\"typ-str\">&quot;normal&quot;</span></code>と<code><span class=\"typ-str\">&quot;page&quot;</span></code>の2種類があります。</p>\n<p>デフォルトの<code><span class=\"typ-str\">&quot;normal&quot;</span></code>参照では、ラベルに対するテキスト形式の参照が作られます。\n例えば見出しへの参照なら、&quot;Section 1&quot;などのような適切な文字列が表示されます。\nこの参照は、該当する要素へのリンクとしても機能します。\nまた、参照の構文は文献リストからの引用を行う<a href=\"/docs/reference/model/cite/\" title=\"cite\">cite</a>にも使用できます。</p>\n<p>このデフォルト形式では補足語と番号が必要なため、ラベルは <em>参照可能な要素</em> に付けなくてはなりません。\n参照可能な要素としては、\n<a href=\"/docs/reference/model/heading/\">headings</a>、<a href=\"/docs/reference/model/figure/\">figures</a>、<a href=\"/docs/reference/math/equation/\">equations</a>、<a href=\"/docs/reference/model/footnote/\">footnotes</a>\nなどがあります。\n定理（theorem）などのカスタム参照可能要素を作成したい場合は、カスタム<a href=\"/docs/reference/model/figure/#parameters-kind\"><code>kind</code></a>の図表として作成し、それに対応するshowルールを書くことで作成可能です。\n将来的には、カスタム参照可能要素をもっと直接的に定義する方法が導入されるかもしれません。</p>\n<h2 id=\"例\">例</h2>\n<div class=\"previewed-code\"><pre><code><span class=\"typ-key\">#</span><span class=\"typ-key\">set</span> <span class=\"typ-func\">page</span><span class=\"typ-punct\">(</span>numbering<span class=\"typ-punct\">:</span> <span class=\"typ-str\">&quot;1&quot;</span><span class=\"typ-punct\">)</span>\n<span class=\"typ-key\">#</span><span class=\"typ-key\">set</span> <span class=\"typ-func\">heading</span><span class=\"typ-punct\">(</span>numbering<span class=\"typ-punct\">:</span> <span class=\"typ-str\">&quot;1.&quot;</span><span class=\"typ-punct\">)</span>\n<span class=\"typ-key\">#</span><span class=\"typ-key\">set</span> math<span class=\"typ-punct\">.</span><span class=\"typ-func\">equation</span><span class=\"typ-punct\">(</span>numbering<span class=\"typ-punct\">:</span> <span class=\"typ-str\">&quot;(1)&quot;</span><span class=\"typ-punct\">)</span>\n\n<span class=\"typ-heading\">= Introduction</span> <span class=\"typ-label\">&lt;intro&gt;</span>\nRecent developments in\ntypesetting software have\nrekindled hope in previously\nfrustrated researchers. <span class=\"typ-ref\">@distress</span>\nAs shown in <span class=\"typ-ref\">@results</span> (see\n<span class=\"typ-func\">#</span><span class=\"typ-func\">ref</span><span class=\"typ-punct\">(</span><span class=\"typ-label\">&lt;results&gt;</span><span class=\"typ-punct\">,</span> form<span class=\"typ-punct\">:</span> <span class=\"typ-str\">&quot;page&quot;</span><span class=\"typ-punct\">)</span>),\nwe <span class=\"typ-escape\">...</span>\n\n<span class=\"typ-heading\">= Results</span> <span class=\"typ-label\">&lt;results&gt;</span>\nWe discuss our approach in\ncomparison with others.\n\n<span class=\"typ-heading\">== Performance</span> <span class=\"typ-label\">&lt;perf&gt;</span>\n<span class=\"typ-ref\">@slow</span> demonstrates what slow\nsoftware looks like.\n<span class=\"typ-math-delim\">$</span> T(n) = O(2<span class=\"typ-math-op\">^</span>n) <span class=\"typ-math-delim\">$</span> <span class=\"typ-label\">&lt;slow&gt;</span>\n\n<span class=\"typ-func\">#</span><span class=\"typ-func\">bibliography</span><span class=\"typ-punct\">(</span><span class=\"typ-str\">&quot;works.bib&quot;</span><span class=\"typ-punct\">)</span>\n</code></pre><div class=\"preview\"><img src=\"/docs/assets/a792745ccec945a90763138d4e45762f.png\" alt=\"Preview\"></div></div>\n<h2 id=\"syntax\">Syntax</h2>\n<p>この機能には専用の記法も用意されています。\n<code><span class=\"typ-str\">&quot;normal&quot;</span></code> の参照を作成するためには<code>@</code>に続けてラベル名を入力します。\n（例えば<code><span class=\"typ-heading\">= Introduction</span> <span class=\"typ-label\">&lt;intro&gt;</span></code>というラベルを参照するには<code><span class=\"typ-ref\">@intro</span></code>と入力します）</p>\n<p>補足語をカスタマイズするには、\n<code><span class=\"typ-ref\">@intro<span class=\"typ-punct\">[</span>Chapter<span class=\"typ-punct\">]</span></span></code>のように、参照の後に角括弧でコンテンツを追加します。</p>\n<h2 id=\"カスタム\">カスタム</h2>\n<p>参照のshowルールを書く場合、\n参照の<code>element</code>フィールドを通じて参照先の要素にアクセスできます。\nただし、Typstがまだそれを発見していない場合、<code>element</code>は存在していても<code><span class=\"typ-key\">none</span></code>になる可能性があるため、\n常にコード内でそのケースを処理する必要があります。</p>\n<div class=\"previewed-code\"><pre><code><span class=\"typ-key\">#</span><span class=\"typ-key\">set</span> <span class=\"typ-func\">heading</span><span class=\"typ-punct\">(</span>numbering<span class=\"typ-punct\">:</span> <span class=\"typ-str\">&quot;1.&quot;</span><span class=\"typ-punct\">)</span>\n<span class=\"typ-key\">#</span><span class=\"typ-key\">set</span> math<span class=\"typ-punct\">.</span><span class=\"typ-func\">equation</span><span class=\"typ-punct\">(</span>numbering<span class=\"typ-punct\">:</span> <span class=\"typ-str\">&quot;(1)&quot;</span><span class=\"typ-punct\">)</span>\n\n<span class=\"typ-key\">#</span><span class=\"typ-key\">show</span> <span class=\"typ-func\">ref</span><span class=\"typ-punct\">:</span> it <span class=\"typ-op\">=&gt;</span> <span class=\"typ-punct\">{</span>\n  <span class=\"typ-key\">let</span> eq <span class=\"typ-op\">=</span> math<span class=\"typ-punct\">.</span>equation\n  <span class=\"typ-key\">let</span> el <span class=\"typ-op\">=</span> it<span class=\"typ-punct\">.</span>element\n  <span class=\"typ-key\">if</span> el <span class=\"typ-op\">!=</span> <span class=\"typ-key\">none</span> <span class=\"typ-key\">and</span> el<span class=\"typ-punct\">.</span><span class=\"typ-func\">func</span><span class=\"typ-punct\">(</span><span class=\"typ-punct\">)</span> <span class=\"typ-op\">==</span> eq <span class=\"typ-punct\">{</span>\n    <span class=\"typ-comment\">// Override equation references.</span>\n    <span class=\"typ-func\">link</span><span class=\"typ-punct\">(</span>el<span class=\"typ-punct\">.</span><span class=\"typ-func\">location</span><span class=\"typ-punct\">(</span><span class=\"typ-punct\">)</span><span class=\"typ-punct\">,</span><span class=\"typ-func\">numbering</span><span class=\"typ-punct\">(</span>\n      el<span class=\"typ-punct\">.</span>numbering<span class=\"typ-punct\">,</span>\n      <span class=\"typ-op\">..</span><span class=\"typ-func\">counter</span><span class=\"typ-punct\">(</span>eq<span class=\"typ-punct\">)</span><span class=\"typ-punct\">.</span><span class=\"typ-func\">at</span><span class=\"typ-punct\">(</span>el<span class=\"typ-punct\">.</span><span class=\"typ-func\">location</span><span class=\"typ-punct\">(</span><span class=\"typ-punct\">)</span><span class=\"typ-punct\">)</span>\n    <span class=\"typ-punct\">)</span><span class=\"typ-punct\">)</span>\n  <span class=\"typ-punct\">}</span> <span class=\"typ-key\">else</span> <span class=\"typ-punct\">{</span>\n    <span class=\"typ-comment\">// Other references as usual.</span>\n    it\n  <span class=\"typ-punct\">}</span>\n<span class=\"typ-punct\">}</span>\n\n<span class=\"typ-heading\">= Beginnings</span> <span class=\"typ-label\">&lt;beginning&gt;</span>\nIn <span class=\"typ-ref\">@beginning</span> we prove <span class=\"typ-ref\">@pythagoras</span>.\n<span class=\"typ-math-delim\">$</span> a<span class=\"typ-math-op\">^</span>2 + b<span class=\"typ-math-op\">^</span>2 = c<span class=\"typ-math-op\">^</span>2 <span class=\"typ-math-delim\">$</span> <span class=\"typ-label\">&lt;pythagoras&gt;</span>\n</code></pre><div class=\"preview\"><img src=\"/docs/assets/ff69119c08e1a5967e92f26ccad7e5ca.png\" alt=\"Preview\"></div></div>","example":null,"self":false,"params":[{"name":"target","details":"<p>参照されるべき対象ラベル。</p>\n<p>これは、ドキュメント内で定義されたラベルや、\n<a href=\"/docs/reference/model/bibliography/\"><code>参考文献リスト</code></a>の参照キーである場合があります。</p>","example":null,"types":["label"],"strings":[],"default":null,"positional":true,"named":false,"required":true,"variadic":false,"settable":false},{"name":"supplement","details":"<p>参照の補足語。</p>\n<p><a href=\"/docs/reference/model/ref/#parameters-form\"><code>form</code></a>が<code><span class=\"typ-str\">&quot;normal&quot;</span></code>で設定されている場合は以下の通りです。</p>\n<ul>\n<li>見出しや図への参照では、この値が参照番号の前に追加されます。</li>\n<li>文献引用の場合は、ページ番号などを追記するのに使えます。</li>\n</ul>\n<p>もし<a href=\"/docs/reference/model/ref/#parameters-form\"><code>form</code></a>が<code><span class=\"typ-str\">&quot;page&quot;</span></code>に設定されている場合には、\n参照先ラベルのページ番号の前にこの値が追加されます。</p>\n<p>また、関数が指定されている場合は、それに参照先の要素が渡され、戻り値のコンテンツが補足語となります。</p>","example":"<div class=\"previewed-code\"><pre><code><span class=\"typ-key\">#</span><span class=\"typ-key\">set</span> <span class=\"typ-func\">heading</span><span class=\"typ-punct\">(</span>numbering<span class=\"typ-punct\">:</span> <span class=\"typ-str\">&quot;1.&quot;</span><span class=\"typ-punct\">)</span>\n<span class=\"typ-key\">#</span><span class=\"typ-key\">show</span> ref<span class=\"typ-punct\">.</span><span class=\"typ-func\">where</span><span class=\"typ-punct\">(</span>\n  form<span class=\"typ-punct\">:</span> <span class=\"typ-str\">&quot;normal&quot;</span>\n<span class=\"typ-punct\">)</span><span class=\"typ-punct\">:</span> <span class=\"typ-key\">set</span> <span class=\"typ-func\">ref</span><span class=\"typ-punct\">(</span>supplement<span class=\"typ-punct\">:</span> it <span class=\"typ-op\">=&gt;</span> <span class=\"typ-punct\">{</span>\n  <span class=\"typ-key\">if</span> it<span class=\"typ-punct\">.</span><span class=\"typ-func\">func</span><span class=\"typ-punct\">(</span><span class=\"typ-punct\">)</span> <span class=\"typ-op\">==</span> heading <span class=\"typ-punct\">{</span>\n    <span class=\"typ-str\">&quot;Chapter&quot;</span>\n  <span class=\"typ-punct\">}</span> <span class=\"typ-key\">else</span> <span class=\"typ-punct\">{</span>\n    <span class=\"typ-str\">&quot;Thing&quot;</span>\n  <span class=\"typ-punct\">}</span>\n<span class=\"typ-punct\">}</span><span class=\"typ-punct\">)</span>\n\n<span class=\"typ-heading\">= Introduction</span> <span class=\"typ-label\">&lt;intro&gt;</span>\nIn <span class=\"typ-ref\">@intro</span>, we see how to turn\nSections into Chapters. And\nin <span class=\"typ-ref\">@intro<span class=\"typ-punct\">[</span>Part<span class=\"typ-punct\">]</span></span>, it is done\nmanually.\n</code></pre><div class=\"preview\"><img src=\"/docs/assets/aa86f60f6632f6ef7a93b80a5a97c7d1.png\" alt=\"Preview\"></div></div>","types":["none","auto","content","function"],"strings":[],"default":"<code><span class=\"typ-key\">auto</span></code>","positional":false,"named":true,"required":false,"variadic":false,"settable":true},{"name":"form","details":"<p>生成する参照の種類</p>","example":"<div class=\"previewed-code\"><pre><code><span class=\"typ-key\">#</span><span class=\"typ-key\">set</span> <span class=\"typ-func\">page</span><span class=\"typ-punct\">(</span>numbering<span class=\"typ-punct\">:</span> <span class=\"typ-str\">&quot;1&quot;</span><span class=\"typ-punct\">)</span>\n\nHere <span class=\"typ-label\">&lt;here&gt;</span> we are on\n<span class=\"typ-func\">#</span><span class=\"typ-func\">ref</span><span class=\"typ-punct\">(</span><span class=\"typ-label\">&lt;here&gt;</span><span class=\"typ-punct\">,</span> form<span class=\"typ-punct\">:</span> <span class=\"typ-str\">&quot;page&quot;</span><span class=\"typ-punct\">)</span>.\n</code></pre><div class=\"preview\"><img src=\"/docs/assets/7c0b8deae09773dbb50f5ed89759c240.png\" alt=\"Preview\"></div></div>","types":["str"],"strings":[{"string":"normal","details":"<p>ラベルに対して文字列での参照を生成します。</p>"},{"string":"page","details":"<p>ラベルに対してページ番号での参照を生成します。</p>"}],"default":"<code><span class=\"typ-str\">&quot;normal&quot;</span></code>","positional":false,"named":true,"required":false,"variadic":false,"settable":true}],"returns":["content"],"scope":[]}}}